<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="utf-8">
 <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
 <meta name="description" content="Cereal Manufacturer analysis">
 <meta name="author" content="ashnaanil">
 <title> CS 416 Final Project (aanil2) </title>
 <link href="cereal.css" rel="stylesheet">
</head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-annotation/2.5.1/d3-annotation.js" integrity="sha512-OYIn9Tx6AQ/OfeUow7zLScBXV38CqumwIpue7WoR7RczlHJUVU+GqJmQ2Zmq/NrRsMhCN4EDGM4Wp97iTo34Jw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-annotation/2.5.1/d3-annotation.min.js" integrity="sha512-iBAeBWWWFb8HqSBcrqcz98iIpuVH1la39dEYHtyQ/pGpeCQTQVvLJOWAuhv2Q7JSHp9k7hWA7sGxU3hHJe+tFg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-annotation/2.5.1/d3-annotation.independent.js" integrity="sha512-w4Lgu5/zPkEMQV0p8a/j9rVhetarK5fyhtIoucJRmB26GF/xeX1lyF24lE4UAVpt7rt1eCrN+AhVK6njqoLJ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-annotation/2.5.1/d3-annotation.independent.min.js" integrity="sha512-89IU2quof1oR2mYXl38GkyY7HQFyHtzubPPEP7DlLNAkO6FH/3AHByuHAfi0zvLP4hMtggXASW9gFzQEYn8rWg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-annotation/2.5.1/d3-annotation.js" integrity="sha512-OYIn9Tx6AQ/OfeUow7zLScBXV38CqumwIpue7WoR7RczlHJUVU+GqJmQ2Zmq/NrRsMhCN4EDGM4Wp97iTo34Jw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	
<body id="Top">	
<nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top" id="sideNav">
	<div class="collapse navbar-collapse" id="navbarSupportedContent">
	<img src="cereal-ranked.jpg" width = "240" height = "190" alt="">
	<ul class="navbar-nav" style="list-style: none;">
  		<li class="nav-item"> 
  		<a class="nav-link " href="#Overview">Overview</a>
  		</li>
		<br>
		<li class="nav-item">
   		<a class="nav-link" href="#rating">Rating Stats</a>
  		</li>
		<br>
  		<li class="nav-item">
   		<a class="nav-link " href="#Stats">Manufacturer Stats</a>
  		</li>
		<br>
	  	<li class="nav-item">
   		<a class="nav-link " href="#sources">Sources</a>
  		</li>
        </ul>
	<img src="sugar.png" width = "240" height = "180" alt="">
	<br>
	<img src="Cereal-and-milk.jpg" width = "240" height = "190" alt="">
	<br>
	<img src="choco.png" width = "240" height = "260" alt="">
	</div>
  </nav>
	
<h1 style=font-size:30px> CEREALS - Narrative Visualization </h1>
<div>
      <section id="Overview">
      	<h1 style=font-size:30px> Overview </h1>
          <div>
		  This is a Visualization about Cereal Manuactures and metrics about their cereals such as the ratings, calories, proteins etc..
		  <br>
		  The <span style="color:red"> main aim </span> of this is to understand the top rated cereals from the cereal manufacures and see the relationship between this rating and other nutritional metrics such as calories, sugars, vitamins etc..
          </div>
     
            <h4> Cereal Manufacturers Descriptions </h4>
            <ul>
		    <li> A = American Home Food Products </li>
		    <li> K = General Mills </li>
		    <li> N = Kelloggs </li>
		    <li> P = Nabisco </li>
		    <li> Q = Post </li>
		    <li> R = Quaker Oats </li>
		    <li> A = Ralston Purina </li>
            </ul>
	    <h4> Nutritional Metrics Descriptions</h4>
            <ul>
		    <li> Rating = rating of the cereal (from consumer reports) </li>
		    <li> Calories = calories per serving </li>
		    <li> Sugars = grams of sugar </li>
		    <li> Proteins = grams of protein </li>
		    <li> Vitamins = indicating the typical % of FDA recommended </li>
            </ul>
      
	      <h4> Top 5 Cereals/Mfr's by Ratings! </h4>
	      <div id = "top10"> </div>
	      <svg id='svg-8' width='1000' height="600"float="left"></svg>
	      <h3> Some key observations based on the data above </h3>
	      <li>As we can see here the highest is All-Bran with Extra Fiber by General Mills. </li>
	      (This is seen in the chart in the Manufacturer Stats Section as well.)
	     <br> <li>Kelloggs manufactures 4/5 Top rated cereals on the list! </li>
	     <br>
	      <br>
      <a class="button" href="#rating" font-size='40px'> Next </a>
     
      </section>
</div>
	 <br>      
<hr style="height:2px;border-width:0;color:black;background-color:black">
	
<div>
   <section id="rating">
          <h1 style=font-size:30px>Factors that might affect the Ratings</h1>
	   <p> The graph below shows the relationship between the ratings and key nutritional metrics such as Calories, Sugars, Proteins Vitamins etc. 
		<br>
	       (These values have been normalized to show the amount per cup.)
		<br>
		   <br>
		   You can toggle between the different metrics by choosing the buttons below and seeing the relationships on the chart.
	   </p>
	    <button class='button' onclick="showratings_vs_cals();" style="background-color:#a12731;color:white" > Calories </button>
            <button class='button' onclick="showratings_vs_sugars();" style="background-color:#b57735;color:white"> Sugars </button>
	    <button class='button' onclick="showratings_vs_proteins();" style="background-color:#2955c4;color:white"> Proteins </button>
	    <button class='button' onclick="showratings_vs_vitamins();" style="background-color:#339149;color:white"> Vitamins </button>
	    <br>
          <svg id='svg-4' width='1000' height="600"float="left"></svg>
	  <svg id='svg-5' width='1000' height="600"float="left" display='none'></svg>
	  <svg id='svg-6' width='1000' height="600"float="left" display='none'></svg>
	  <svg id='svg-7' width='1000' height="600"float="left" display='none'></svg>
	   <br>
	   <br>
	    As seen above, you can get an overall sense of these relationships:
	   <br>
	   <br>
	   <span style="color:#a12731"> 1. Calories don't have too much of an imapct on the Cereal Ratings and most of the calories per cup are < 300. </span>
	   <br>
	   <span style="color:#b57735"> 2. Sugars have a slight negative impact and most of the highly rated cereals (60+) have 0 sugar.  </span>
	   <br>
	   <span style="color:#2955c4"> 3. Proteins have a stronger positive relationship with Ratings.  </span>
	   <br>
	   <span style="color:#339149"> 4. Vitamins don't have too much of an imapct on the Cereal Ratings but most of the highly rated cereals (60+) have 0 vitamins.  </span>
	  <br>
	   <br>
          <a class="button" href="#Stats" font-size='40px'> Next </a>
          <br>
	   <br>
          <a class="button" href="#Top" font-size='40px'> Return </a>
	 
	</section>
</div>
 <br>
<hr style="height:2px;border-width:0;color:black;background-color:black">

<div>		
	<section id = "Stats">
	  <h1 style=font-size:30px>Cereal Manufacturer Statistics</h1>
	    <p2> This section shows you an overview of the cereals with the highest rating/calories by the manufacturer. 
            <br> 
	    <br>
	    You can toggle between the buttons to see the different views:
	    <br>
	    <br>
            <button class='button' onclick="showratings();">Manufacturer By Highest Ratings </button>
            <button class='button' onclick="showcalories();" > Manufacturer By Highest Calories </button>
	    <br>
	     <br>
            <svg id='svg-2' width='1000' height="600"float="left" display='none'></svg>
            <svg id='svg-3' width='1000' height="600"float="left"></svg>
	    <br> 
	      As seen in the annotation above, <strong> <span style="color:red" font-weight: bold> General Mills </span> </strong> manufactures the cereal with the highest rating and the highest amount of calories per cup!
	    <br>   
            <br>
	    <a class="button" href="#sources" font-size='40px'> Next </a>
	    <br>
	     <br>
            <a class="button" href="#Top" font-size='40px'> Return </a>
	    <br>
            </section>
</div>	
 <br>
<hr style="height:2px;border-width:0;color:black;background-color:black">

<div>
      <section id="sources">
            <h2> Sources </h2>
	    These are the sources that I referenced while creating this visualization project:
            <ul>
		    <li>  https://d3-graph-gallery.com/graph/scatter_basic.html </li>
		    <li>  https://www.kaggle.com/datasets/crawford/80-cereals </li>
		    <li>    https://d3-annotation.susielu.com/ </li>
            </ul>
	    <p> THANK YOU :)
		<BR>
		HOPE YOU ENJOYED THE VISUALIZATION! 
	    </P>
            <a class="button" href="#Top" font-size='40px'> Return </a>
      </section>
</div>

		
<script src="https://d3js.org/d3.v4.min.js"></script>	      
<script>

// show the ratings graph
    function showratings(){
     	var y = document.getElementById("svg-2")
     	y.style.display="none"
     	var z=document.getElementById("svg-3")
     	z.style.display="block"
     }

// show the calories graph
    function showcalories(){
       	var y = document.getElementById("svg-2")
       	y.style.display="block"
       	var z=document.getElementById("svg-3")
       	z.style.display="none"
    }

// show the ratings vs calories graph
    function showratings_vs_cals(){
     	var y = document.getElementById("svg-4")
     	y.style.display="block"
     	var z=document.getElementById("svg-5")
     	z.style.display="none"
	var q =document.getElementById("svg-6")
     	q.style.display="none"
	var w =document.getElementById("svg-7")
     	w.style.display="none"
     }

// show the ratings vs sugars graph
    function showratings_vs_sugars(){
       	var y = document.getElementById("svg-4")
       	y.style.display="none"
       	var z=document.getElementById("svg-5")
       	z.style.display="block"
	var q =document.getElementById("svg-6")
     	q.style.display="none"
	var w =document.getElementById("svg-7")
     	w.style.display="none"
    }

// show the ratings vs vitamins graph
    function showratings_vs_vitamins(){
       	var y = document.getElementById("svg-4")
       	y.style.display="none"
       	var z=document.getElementById("svg-5")
       	z.style.display="none"
	var q =document.getElementById("svg-6")
     	q.style.display="block"
	var w =document.getElementById("svg-7")
     	w.style.display="none"
    }
	
// show the ratings vs proteins graph
    function showratings_vs_proteins(){
       	var y = document.getElementById("svg-4")
       	y.style.display="none"
       	var z=document.getElementById("svg-5")
       	z.style.display="none"
	var q =document.getElementById("svg-6")
     	q.style.display="none"
	var w =document.getElementById("svg-7")
     	w.style.display="block"
    }
	
	
  // declaring svgs
  var svg2 = d3.select("#svg-2") 
  var svg3 = d3.select('#svg-3') 
  var svg4 = d3.select('#svg-4') 
  var svg5 = d3.select('#svg-5') 
  var svg6 = d3.select('#svg-6') 
  var svg7 = d3.select('#svg-7') 
  var svg8 = d3.select('#svg-8') 
  
  // setting parameters
  var margin = {top: 10, right: 30, bottom: 40, left: 70}
  var width = +svg2.attr("width") - margin.left - margin.right
  var height = +svg2.attr("height") - margin.top - margin.bottom
  
  // declaring group objects
  var g2 = svg2.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");
  var g3 = svg3.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");
  var g4 = svg4.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");
  var g5 = svg5.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");
  var g6 = svg6.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");
  var g7 = svg7.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");
  var g8 = svg8.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");
	
  // declaring scales
  var x = d3.scaleBand().rangeRound([0, width]).paddingInner(0.1);
  var y = d3.scaleLinear().rangeRound([height, 0]);
  var x1 = d3.scaleLinear().range([-0, width]).domain([0, 100]);
  var y1 = d3.scaleLinear().range([height, 0]);

	
//top5 rated cereal chart
    d3.csv("cereal.csv", function(d) {
      return d;
    }, function(error, data) {
      if (error) throw error;
      var top5 = data.sort(function(a,b) {
		    return d3.descending(+a.rating, +b.rating);
      }).slice(0,5)
      console.log(top5.map(function(d) { return d.item; }))
      x.domain(top5.map(function(d) { return d.name; }));
      y.domain([0, 100]);
      g8.append("g")
	 .selectAll(".bar")
	    .data(top5)
	    .enter()
	    .append("rect")
	    .attr("class", "bar")
	    .style("fill", "#a12731")
	    .attr("x", function(d) { return x(d.name); })
	    .attr("y", function(d) { return y(d.rating); })
	    .attr("width", x.bandwidth())
	    .attr("height", function(d) { return height - y(d.rating); }); 
      g8.append("g")
          .attr("class", "axis")
          .call(d3.axisBottom(x))
          .attr("transform", "translate(0," + height + ")")
	 .append("text")
	    .attr("x", width - 200)
	    .attr("y", 30)
	    .attr("text-anchor", "end")
	    .attr("stroke", "black")
	    .text("Cereal");
      g8.append("g")
          .attr("class", "axis")
          .call(d3.axisLeft(y).ticks(null, "s"))
        .append("text")
          .attr("x", 2)
          .attr("y", y(y.ticks().pop()) + 0.5)
          .attr("dy", "0.32em")
          .attr("fill", "#000")
          .attr("font-weight", "bold")
          .attr("text-anchor", "start")
          .text("Rating");
	g8.append("g")
	    .text(function(d) { return y(d.rating); })
	    .attr("x", function(d){ return x(d) + x.bandwidth()/2; })
	    .attr("y", function(d){ return y(data[d]) - 5; })
	    .attr("font-family" , "sans-serif")
	    .attr("font-size" , "14px")
	    .attr("fill" , "black")
	    .attr("text-anchor", "middle");	    
    });
	

	
   //mfr vs calories chart
    d3.csv("cereal.csv", function(d) {
      return d;
    }, function(error, data) {
      if (error) throw error;
      x.domain(data.map(function(d) { return d.mfr; }));
      y.domain([0, 200]);
      g2.append("g")
	 .selectAll(".bar")
	    .data(data)
	    .enter()
	    .append("rect")
	    .attr("class", "bar")
	    .style("fill", "#000")
	    .attr("x", function(d) { return x(d.mfr); })
	    .attr("y", function(d) { return y(d.calories); })
	    .attr("width", x.bandwidth())
	    .attr("height", function(d) { return height - y(d.calories); });  	      
      g2.append("g")
          .attr("class", "axis")
          .call(d3.axisBottom(x))
          .attr("transform", "translate(0," + height + ")")
	 .append("text")
	    .attr("x", width - 200)
	    .attr("y", 30)
	    .attr("text-anchor", "end")
	    .attr("stroke", "black")
	    .text("Manufacturer");
      g2.append("g")
          .attr("class", "axis")
          .call(d3.axisLeft(y).ticks(null, "s"))
        .append("text")
          .attr("x", 2)
          .attr("y", y(y.ticks().pop()) + 0.5)
          .attr("dy", "0.32em")
          .attr("fill", "#000")
          .attr("font-weight", "bold")
          .attr("text-anchor", "start")
          .text("Calories");
    });
	
      
    //mfr vs ratings chart
    d3.csv("cereal.csv", function(d) {
      return d;
    }, function(error, data) {
      if (error) throw error;
      x.domain(data.map(function(d) { return d.mfr; }));
      y.domain([0, 100]);
      g3.append("g")
	 .selectAll(".bar")
	    .data(data)
	    .enter()
	    .append("rect")
	    .attr("class", "bar")
	    .attr("x", function(d) { return x(d.mfr); })
	    .attr("y", function(d) { return y(d.rating); })
	    .attr("width", x.bandwidth())
	    .attr("height", function(d) { return height - y(d.rating); });   	  
      g3.append("g")
          .attr("class", "axis")
          .call(d3.axisBottom(x))
          .attr("transform", "translate(0," + height + ")")
	 .append("text")
	    .attr("x", width - 200)
	    .attr("y", 30)
	    .attr("text-anchor", "end")
	    .attr("stroke", "black")
	    .text("Manufacturer");
      g3.append("g")
          .attr("class", "axis")
          .call(d3.axisLeft(y).ticks(null, "s"))
        .append("text")
          .attr("x", 2)
          .attr("y", y(y.ticks().pop()) + 0.5)
          .attr("dy", "0.32em")
          .attr("fill", "#000")
          .attr("text-anchor", "start")
	   .attr("font-weight", "bold")
          .text("Ratings");   
	   
	    var dataSum = d3.sum(data, function(d) {
  		return d.rating;
	   });
	    
	g3.append("line")
	    .attr("x1", x(1))
	    .attr("x2", width)
	    .attr("y1", y(dataSum / data.length))
	    .attr("y2", y(dataSum / data.length));
    });
	
    //ratings vs calories
    d3.csv("cereal.csv", function(d) {
      return d;
    }, function(error, data) {
      if (error) throw error;
      y1.domain([0,d3.max(data, function(d) { return d.calories/d.cups;})]);
      g4.append("g")
	    .selectAll("dot")
	    .data(data)
	    .enter()
	    .append("circle")
	    .attr("cx", function(d) {return x1(d.rating); })
	    .attr("cy", function(d) {return y1(d.calories/d.cups); })
	    .attr("r", 3)
	    .style("fill", "#a12731")
      g4.append("g")
          .call(d3.axisLeft(y1))
          .append("text")
          .attr("fill", "#000")
          .attr("transform", "rotate(-90)")
          .attr("y", -15)
          .attr("dy", "1em")
          .attr("text-anchor", "end")
          .text("Calories");
     g4.append("g")
          .call(d3.axisBottom(x1))
	  .attr("transform", "translate(-5," + height + ")")
	  .append("text")
          .attr("x",width/2)
          .attr("y",-5)
          .attr("fill","#000")
          .attr("font-weight","bold")
          .attr("text-anchor","start")
          .text("Ratings");
     
    });
	

    //ratings vs sugars
    d3.csv("cereal.csv", function(d) {
      return d;
    }, function(error, data) {
      if (error) throw error;
      y1.domain([0,d3.max(data, function(d) { return d.sugars/d.cups;})]);
      g5.append("g")
	    .selectAll("dot")
	    .data(data)
	    .enter()
	    .append("circle")
	    .attr("cx", function(d) {return x1(d.rating); })
	    .attr("cy", function(d) {return y1(d.sugars/d.cups); })
	    .attr("r", 3)
	    .style("fill", "#b57735")
      g5.append("g")
          .call(d3.axisLeft(y1))
          .append("text")
          .attr("fill", "#000")
          .attr("transform", "rotate(-90)")
          .attr("y", -15)
          .attr("dy", "1em")
          .attr("text-anchor", "end")
          .text("Sugars");
     g5.append("g")
          .call(d3.axisBottom(x1))
	  .attr("transform", "translate(-5," + height + ")")
	  .append("text")
          .attr("x",width/2)
          .attr("y",-5)
          .attr("fill","#000")
          .attr("font-weight","bold")
          .attr("text-anchor","start")
          .text("Ratings");
     
    });
	
    //ratings vs proteins
    d3.csv("cereal.csv", function(d) {
      return d;
    }, function(error, data) {
      if (error) throw error;
      y1.domain([0,d3.max(data, function(d) { return d.protein/d.cups;})]);
      g7.append("g")
	    .selectAll("dot")
	    .data(data)
	    .enter()
	    .append("circle")
	    .attr("cx", function(d) {return x1(d.rating); })
	    .attr("cy", function(d) {return y1(d.protein/d.cups); })
	    .attr("r", 3)
	    .style("fill", "#2955c4")
      g7.append("g")
          .call(d3.axisLeft(y1))
          .append("text")
          .attr("fill", "#000")
          .attr("transform", "rotate(-90)")
          .attr("y", -15)
          .attr("dy", "1em")
          .attr("text-anchor", "end")
          .text("Proteins");
     g7.append("g")
          .call(d3.axisBottom(x1))
	  .attr("transform", "translate(-5," + height + ")")
	  .append("text")
          .attr("x",width/2)
          .attr("y",-5)
          .attr("fill","#000")
          .attr("font-weight","bold")
          .attr("text-anchor","start")
          .text("Ratings");
     
    });
	
    //ratings vs vitamins
    d3.csv("cereal.csv", function(d) {
      return d;
    }, function(error, data) {
      if (error) throw error;
      y1.domain([0,d3.max(data, function(d) { return d.vitamins/d.cups;})]);
      g6.append("g")
	    .selectAll("dot")
	    .data(data)
	    .enter()
	    .append("circle")
	    .attr("cx", function(d) {return x1(d.rating); })
	    .attr("cy", function(d) {return y1(d.vitamins/d.cups); })
	    .attr("r", 3)
	    .style("fill", "#339149")
      g6.append("g")
          .call(d3.axisLeft(y1))
          .append("text")
          .attr("fill", "#000")
          .attr("transform", "rotate(-90)")
          .attr("y", -15)
          .attr("dy", "1em")
          .attr("text-anchor", "end")
          .text("Vitamins");
     g6.append("g")
          .call(d3.axisBottom(x1))
	  .attr("transform", "translate(-5," + height + ")")
	  .append("text")
          .attr("x",width/2)
          .attr("y",-5)
          .attr("fill","#000")
          .attr("font-weight","bold")
          .attr("text-anchor","start")
          .text("Ratings");
     
    });
	
//selecting top10	
d3.csv("cereal.csv", function(d) {
    return d;
},  function(error, data) {
        if (error) throw error;
    var topData = data.sort(function(a, b) {
          return d3.descending(+a.rating, +b.rating);
       }).slice(0, 5);//top 10 here
    var p = d3.select("#top10")
      .selectAll("p")
      .data(topData)
      .enter()
      .append("p")
      .text(function(d){
        return " o " + d.name + " by " +  d.mfr  +  " has a rating: " +  d.rating;
      });
    });


const annotations = [{
	note: {
	label: "(Manufactured by General Mills as seen in the first section)",
	title: "Highest Rated Cereal"
	}, 
	 x: 390, y: 48, dy: 100, dx: 200
 }].map(function(d) { d.color = "#8a0000"; return d})
 const makeAnn = d3.annotation()
 .type(d3.annotationLabel)
 .annotations(annotations)
d3.select("#svg-3")
.append("g")
.attr("class", "annotation-group")
.call(makeAnn)

	
const annotations2 = [{
	note: {
	label: "Highest Calorific Cereal (Manufactured by General Mills as well)",
	}, 
	 x: 390, y: 120, dy: 5, dx: 100
 }].map(function(d) { d.color = "#120000"; return d})
 const makeAnn2 = d3.annotation()
 .type(d3.annotationLabel)
 .annotations(annotations2)
d3.select("#svg-2")
.append("g")
.attr("class", "annotation-group")
.call(makeAnn2)

	
    </script>

  </body>

</html>

